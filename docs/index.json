{"repository_name":"","body":"# Hatty\n\nA library for creating HTTP services in Crystal\n\n```crystal\nrequire \"hatty\"\n\nget \"/\" do |request, response|\n  response.send_text \"Hello there!\"\nend\n\nHatty.start\n```\n\n## Installing\n\nAdd this snippet to your `shards.yml` file\n\n```yml\ndependencies:\n  hatty:\n    github: semlette/hatty\n```\n\n## Usage\n\n> All of the following examples expects that Hatty has been required and started.\n\n```crystal\nrequire \"hatty\"\n\n# ...\n\nHatty.start\n```\n\n### Listening for requests\n\n```crystal\nget \"/\" do |request, response|\n  response.send_text \"It's alive!\"\nend\n\npost \"/\" do |request, response|\n  # ...\nend\n\nput \"/\" do |request, response|\n  # ...\nend\n\ndelete \"/\" do |request, response|\n  # ...\nend\n\npatch \"/\" do |request, response|\n  # ...\nend\n```\n","program":{"html_id":"/toplevel","path":"toplevel.html","kind":"module","full_name":"Top Level Namespace","name":"Top Level Namespace","abstract":false,"superclass":null,"ancestors":[],"locations":[],"repository_name":"","program":true,"enum":false,"alias":false,"aliased":"","const":false,"constants":[],"included_modules":[],"extended_modules":[],"subclasses":[],"including_types":[],"namespace":null,"doc":null,"summary":null,"class_methods":[{"id":"delete(path,&handler:Hatty::Handler)-class-method","html_id":"delete(path,&amp;handler:Hatty::Handler)-class-method","name":"delete","doc":null,"summary":null,"abstract":false,"args":[{"name":"path","doc":null,"default_value":"","external_name":"path","restriction":""}],"args_string":"(path, &handler : Hatty::Handler)","source_link":null,"source_link":null,"def":{"name":"delete","args":[{"name":"path","doc":null,"default_value":"","external_name":"path","restriction":""}],"double_splat":null,"splat_index":null,"yields":0,"block_arg":{"name":"handler","doc":null,"default_value":"","external_name":"handler","restriction":"Hatty::Handler"},"return_type":"","visibility":"Public","body":"Hatty::Router.register(path)\nHatty::Router.add_route(\"DELETE\", path, handler)\n"}},{"id":"get(path:String,&handler:Hatty::Handler)-class-method","html_id":"get(path:String,&amp;handler:Hatty::Handler)-class-method","name":"get","doc":"Listen for `GET` requests on *path*.\n\nExample: Imaginary \"get user\" endpoint.\n```\nget \"/api/users/:id\" do |request, response|\n  user = MyApi.get_user_by_id(request.params[\"id\"])\n  response.send_json({ data: user })\nend","summary":"<p>Listen for <code>GET</code> requests on <em>path</em>.</p>","abstract":false,"args":[{"name":"path","doc":null,"default_value":"","external_name":"path","restriction":"String"}],"args_string":"(path : String, &handler : Hatty::Handler)","source_link":null,"source_link":null,"def":{"name":"get","args":[{"name":"path","doc":null,"default_value":"","external_name":"path","restriction":"String"}],"double_splat":null,"splat_index":null,"yields":0,"block_arg":{"name":"handler","doc":null,"default_value":"","external_name":"handler","restriction":"Hatty::Handler"},"return_type":"","visibility":"Public","body":"Hatty::Router.register(path)\nHatty::Router.add_route(\"GET\", path, handler)\n"}},{"id":"get(resource,headers=HTTP::Headers.new)-class-method","html_id":"get(resource,headers=HTTP::Headers.new)-class-method","name":"get","doc":null,"summary":null,"abstract":false,"args":[{"name":"resource","doc":null,"default_value":"","external_name":"resource","restriction":""},{"name":"headers","doc":null,"default_value":"HTTP::Headers.new","external_name":"headers","restriction":""}],"args_string":"(resource, headers = <span class=\"t\">HTTP</span><span class=\"t\">::</span><span class=\"t\">Headers</span>.<span class=\"k\">new</span>)","source_link":null,"source_link":null,"def":{"name":"get","args":[{"name":"resource","doc":null,"default_value":"","external_name":"resource","restriction":""},{"name":"headers","doc":null,"default_value":"HTTP::Headers.new","external_name":"headers","restriction":""}],"double_splat":null,"splat_index":null,"yields":null,"block_arg":null,"return_type":"","visibility":"Public","body":"request = create_request(\"GET\", resource, headers)\nio = IO::Memory.new\nresponse = HTTP::Server::Response.new(io)\ncontext = HTTP::Server::Context.new(request, response)\nTesting.server.handle_request(context)\nio.rewind\nresponse.close\nHTTP::Client::Response.from_io(io, decompress: false)\n"}},{"id":"patch(path,&handler:Hatty::Handler)-class-method","html_id":"patch(path,&amp;handler:Hatty::Handler)-class-method","name":"patch","doc":null,"summary":null,"abstract":false,"args":[{"name":"path","doc":null,"default_value":"","external_name":"path","restriction":""}],"args_string":"(path, &handler : Hatty::Handler)","source_link":null,"source_link":null,"def":{"name":"patch","args":[{"name":"path","doc":null,"default_value":"","external_name":"path","restriction":""}],"double_splat":null,"splat_index":null,"yields":0,"block_arg":{"name":"handler","doc":null,"default_value":"","external_name":"handler","restriction":"Hatty::Handler"},"return_type":"","visibility":"Public","body":"Hatty::Router.register(path)\nHatty::Router.add_route(\"PATCH\", path, handler)\n"}},{"id":"post(path:String,&handler:Hatty::Handler)-class-method","html_id":"post(path:String,&amp;handler:Hatty::Handler)-class-method","name":"post","doc":"Listen for `POST` requests at *path*.\n\nExample: Imaginary \"create user\" endpoint.\n```\npost \"/api/users\" do |request, response|\n  user = MyApi.create_user(request.body.user)\n  response.send_json({ data: user })\nend","summary":"<p>Listen for <code>POST</code> requests at <em>path</em>.</p>","abstract":false,"args":[{"name":"path","doc":null,"default_value":"","external_name":"path","restriction":"String"}],"args_string":"(path : String, &handler : Hatty::Handler)","source_link":null,"source_link":null,"def":{"name":"post","args":[{"name":"path","doc":null,"default_value":"","external_name":"path","restriction":"String"}],"double_splat":null,"splat_index":null,"yields":0,"block_arg":{"name":"handler","doc":null,"default_value":"","external_name":"handler","restriction":"Hatty::Handler"},"return_type":"","visibility":"Public","body":"Hatty::Router.register(path)\nHatty::Router.add_route(\"POST\", path, handler)\n"}},{"id":"put(path,&handler:Hatty::Handler)-class-method","html_id":"put(path,&amp;handler:Hatty::Handler)-class-method","name":"put","doc":null,"summary":null,"abstract":false,"args":[{"name":"path","doc":null,"default_value":"","external_name":"path","restriction":""}],"args_string":"(path, &handler : Hatty::Handler)","source_link":null,"source_link":null,"def":{"name":"put","args":[{"name":"path","doc":null,"default_value":"","external_name":"path","restriction":""}],"double_splat":null,"splat_index":null,"yields":0,"block_arg":{"name":"handler","doc":null,"default_value":"","external_name":"handler","restriction":"Hatty::Handler"},"return_type":"","visibility":"Public","body":"Hatty::Router.register(path)\nHatty::Router.add_route(\"PUT\", path, handler)\n"}},{"id":"status(code,&handler:Hatty::Handler)-class-method","html_id":"status(code,&amp;handler:Hatty::Handler)-class-method","name":"status","doc":null,"summary":null,"abstract":false,"args":[{"name":"code","doc":null,"default_value":"","external_name":"code","restriction":""}],"args_string":"(code, &handler : Hatty::Handler)","source_link":null,"source_link":null,"def":{"name":"status","args":[{"name":"code","doc":null,"default_value":"","external_name":"code","restriction":""}],"double_splat":null,"splat_index":null,"yields":0,"block_arg":{"name":"handler","doc":null,"default_value":"","external_name":"handler","restriction":"Hatty::Handler"},"return_type":"","visibility":"Public","body":"Hatty::Router.add_route(code, handler)"}}],"constructors":[],"instance_methods":[],"macros":[],"types":[{"html_id":"/Hatty","path":"Hatty.html","kind":"module","full_name":"Hatty","name":"Hatty","abstract":false,"superclass":null,"ancestors":[],"locations":[],"repository_name":"","program":false,"enum":false,"alias":false,"aliased":"","const":false,"constants":[{"name":"VERSION","value":"\"0.1.0\"","doc":null,"summary":null}],"included_modules":[],"extended_modules":[],"subclasses":[],"including_types":[],"namespace":null,"doc":null,"summary":null,"class_methods":[{"id":"config-class-method","html_id":"config-class-method","name":"config","doc":"Returns Hatty's configuration.\n```\nHatty.config.disable_powered_by = true","summary":"<p>Returns Hatty's configuration.</p>","abstract":false,"args":[],"args_string":"","source_link":null,"source_link":null,"def":{"name":"config","args":[],"double_splat":null,"splat_index":null,"yields":null,"block_arg":null,"return_type":"","visibility":"Public","body":"Config::INSTANCE"}},{"id":"configure(&block)-class-method","html_id":"configure(&amp;block)-class-method","name":"configure","doc":"Calls the block with Hatty's configuration.\n```\nHatty.configure do |config|\n  config.disable_powered_by = true\nend\n```","summary":"<p>Calls the block with Hatty's configuration.</p>","abstract":false,"args":[],"args_string":"(&block)","source_link":null,"source_link":null,"def":{"name":"configure","args":[],"double_splat":null,"splat_index":null,"yields":1,"block_arg":null,"return_type":"","visibility":"Public","body":"yield Config::INSTANCE"}},{"id":"start(port=3000)-class-method","html_id":"start(port=3000)-class-method","name":"start","doc":"Starts Hatty.\nThis is a \"shortcut\" for running\n```\nserver = Hatty::Server.new(port: 3000)\nserver.start\n```","summary":"<p>Starts Hatty.</p>","abstract":false,"args":[{"name":"port","doc":null,"default_value":"3000","external_name":"port","restriction":""}],"args_string":"(port = <span class=\"n\">3000</span>)","source_link":null,"source_link":null,"def":{"name":"start","args":[{"name":"port","doc":null,"default_value":"3000","external_name":"port","restriction":""}],"double_splat":null,"splat_index":null,"yields":null,"block_arg":null,"return_type":"","visibility":"Public","body":"server = Server.new(port)\nserver.start\nserver\n"}}],"constructors":[],"instance_methods":[],"macros":[],"types":[{"html_id":"/Hatty/Configuration","path":"Hatty/Configuration.html","kind":"class","full_name":"Hatty::Configuration","name":"Configuration","abstract":false,"superclass":{"html_id":"/Reference","kind":"class","full_name":"Reference","name":"Reference"},"ancestors":[{"html_id":"/Reference","kind":"class","full_name":"Reference","name":"Reference"},{"html_id":"/Object","kind":"class","full_name":"Object","name":"Object"}],"locations":[],"repository_name":"","program":false,"enum":false,"alias":false,"aliased":"","const":false,"constants":[],"included_modules":[],"extended_modules":[],"subclasses":[],"including_types":[],"namespace":{"html_id":"/Hatty","kind":"module","full_name":"Hatty","name":"Hatty"},"doc":null,"summary":null,"class_methods":[],"constructors":[],"instance_methods":[{"id":"disable_powered_by:Bool-instance-method","html_id":"disable_powered_by:Bool-instance-method","name":"disable_powered_by","doc":null,"summary":null,"abstract":false,"args":[],"args_string":" : Bool","source_link":null,"source_link":null,"def":{"name":"disable_powered_by","args":[],"double_splat":null,"splat_index":null,"yields":null,"block_arg":null,"return_type":"","visibility":"Public","body":"@disable_powered_by"}},{"id":"disable_powered_by=(disable_powered_by)-instance-method","html_id":"disable_powered_by=(disable_powered_by)-instance-method","name":"disable_powered_by=","doc":null,"summary":null,"abstract":false,"args":[{"name":"disable_powered_by","doc":null,"default_value":"","external_name":"disable_powered_by","restriction":""}],"args_string":"(disable_powered_by)","source_link":null,"source_link":null,"def":{"name":"disable_powered_by=","args":[{"name":"disable_powered_by","doc":null,"default_value":"","external_name":"disable_powered_by","restriction":""}],"double_splat":null,"splat_index":null,"yields":null,"block_arg":null,"return_type":"","visibility":"Public","body":"@disable_powered_by = disable_powered_by"}}],"macros":[],"types":[]},{"html_id":"/Hatty/Handler","path":"Hatty/Handler.html","kind":"alias","full_name":"Hatty::Handler","name":"Handler","abstract":false,"superclass":null,"ancestors":[],"locations":[],"repository_name":"","program":false,"enum":false,"alias":true,"aliased":"Proc(Hatty::Request, Hatty::Response, Nil)","const":false,"constants":[],"included_modules":[],"extended_modules":[],"subclasses":[],"including_types":[],"namespace":{"html_id":"/Hatty","kind":"module","full_name":"Hatty","name":"Hatty"},"doc":null,"summary":null,"class_methods":[],"constructors":[],"instance_methods":[],"macros":[],"types":[]},{"html_id":"/Hatty/Request","path":"Hatty/Request.html","kind":"class","full_name":"Hatty::Request","name":"Request","abstract":false,"superclass":{"html_id":"/Reference","kind":"class","full_name":"Reference","name":"Reference"},"ancestors":[{"html_id":"/Reference","kind":"class","full_name":"Reference","name":"Reference"},{"html_id":"/Object","kind":"class","full_name":"Object","name":"Object"}],"locations":[],"repository_name":"","program":false,"enum":false,"alias":false,"aliased":"","const":false,"constants":[],"included_modules":[],"extended_modules":[],"subclasses":[],"including_types":[],"namespace":{"html_id":"/Hatty","kind":"module","full_name":"Hatty","name":"Hatty"},"doc":null,"summary":null,"class_methods":[],"constructors":[{"id":"new(request:HTTP::Request)-class-method","html_id":"new(request:HTTP::Request)-class-method","name":"new","doc":null,"summary":null,"abstract":false,"args":[{"name":"request","doc":null,"default_value":"","external_name":"request","restriction":"HTTP::Request"}],"args_string":"(request : HTTP::Request)","source_link":null,"source_link":null,"def":{"name":"new","args":[{"name":"request","doc":null,"default_value":"","external_name":"request","restriction":"HTTP::Request"}],"double_splat":null,"splat_index":null,"yields":null,"block_arg":null,"return_type":"","visibility":"Public","body":"_ = allocate\n_.initialize(request)\nif _.responds_to?(:finalize)\n  ::GC.add_finalizer(_)\nend\n_\n"}}],"instance_methods":[{"id":"body(builder:JSON::Builder)-instance-method","html_id":"body(builder:JSON::Builder)-instance-method","name":"body","doc":null,"summary":null,"abstract":false,"args":[{"name":"builder","doc":null,"default_value":"","external_name":"builder","restriction":"JSON::Builder"}],"args_string":"(builder : JSON::Builder)","source_link":null,"source_link":null,"def":{"name":"body","args":[{"name":"builder","doc":null,"default_value":"","external_name":"builder","restriction":"JSON::Builder"}],"double_splat":null,"splat_index":null,"yields":null,"block_arg":null,"return_type":"","visibility":"Public","body":""}},{"id":"body(mappings)-instance-method","html_id":"body(mappings)-instance-method","name":"body","doc":null,"summary":null,"abstract":false,"args":[{"name":"mappings","doc":null,"default_value":"","external_name":"mappings","restriction":""}],"args_string":"(mappings)","source_link":null,"source_link":null,"def":{"name":"body","args":[{"name":"mappings","doc":null,"default_value":"","external_name":"mappings","restriction":""}],"double_splat":null,"splat_index":null,"yields":null,"block_arg":null,"return_type":"","visibility":"Public","body":""}},{"id":"body-instance-method","html_id":"body-instance-method","name":"body","doc":null,"summary":null,"abstract":false,"args":[],"args_string":"","source_link":null,"source_link":null,"def":{"name":"body","args":[],"double_splat":null,"splat_index":null,"yields":null,"block_arg":null,"return_type":"","visibility":"Public","body":""}},{"id":"method-instance-method","html_id":"method-instance-method","name":"method","doc":null,"summary":null,"abstract":false,"args":[],"args_string":"","source_link":null,"source_link":null,"def":{"name":"method","args":[],"double_splat":null,"splat_index":null,"yields":null,"block_arg":null,"return_type":"","visibility":"Public","body":"@request.method"}},{"id":"original:HTTP::Request-instance-method","html_id":"original:HTTP::Request-instance-method","name":"original","doc":"Returns the original request","summary":"<p>Returns the original request</p>","abstract":false,"args":[],"args_string":" : HTTP::Request","source_link":null,"source_link":null,"def":{"name":"original","args":[],"double_splat":null,"splat_index":null,"yields":null,"block_arg":null,"return_type":"HTTP::Request","visibility":"Public","body":"@request"}},{"id":"params:Hash(String,String)-instance-method","html_id":"params:Hash(String,String)-instance-method","name":"params","doc":null,"summary":null,"abstract":false,"args":[],"args_string":" : Hash(String, String)","source_link":null,"source_link":null,"def":{"name":"params","args":[],"double_splat":null,"splat_index":null,"yields":null,"block_arg":null,"return_type":"Hash(String, String)","visibility":"Public","body":"if @params\n  @params.as(Hash(String, String))\nelse\n  tree_path = Router.tree.find(@request.path)\n  @params = tree_path.params\n  @params.as(Hash(String, String))\nend"}},{"id":"path-instance-method","html_id":"path-instance-method","name":"path","doc":null,"summary":null,"abstract":false,"args":[],"args_string":"","source_link":null,"source_link":null,"def":{"name":"path","args":[],"double_splat":null,"splat_index":null,"yields":null,"block_arg":null,"return_type":"","visibility":"Public","body":"@request.path"}},{"id":"url-instance-method","html_id":"url-instance-method","name":"url","doc":"Alias for `#path`","summary":"<p>Alias for <code><a href=\"../Hatty/Request.html#path-instance-method\">#path</a></code></p>","abstract":false,"args":[],"args_string":"","source_link":null,"source_link":null,"def":{"name":"url","args":[],"double_splat":null,"splat_index":null,"yields":null,"block_arg":null,"return_type":"","visibility":"Public","body":"path"}}],"macros":[],"types":[]},{"html_id":"/Hatty/Response","path":"Hatty/Response.html","kind":"class","full_name":"Hatty::Response","name":"Response","abstract":false,"superclass":{"html_id":"/Reference","kind":"class","full_name":"Reference","name":"Reference"},"ancestors":[{"html_id":"/Reference","kind":"class","full_name":"Reference","name":"Reference"},{"html_id":"/Object","kind":"class","full_name":"Object","name":"Object"}],"locations":[],"repository_name":"","program":false,"enum":false,"alias":false,"aliased":"","const":false,"constants":[],"included_modules":[],"extended_modules":[],"subclasses":[],"including_types":[],"namespace":{"html_id":"/Hatty","kind":"module","full_name":"Hatty","name":"Hatty"},"doc":null,"summary":null,"class_methods":[],"constructors":[{"id":"new(response:HTTP::Server::Response)-class-method","html_id":"new(response:HTTP::Server::Response)-class-method","name":"new","doc":null,"summary":null,"abstract":false,"args":[{"name":"response","doc":null,"default_value":"","external_name":"response","restriction":"HTTP::Server::Response"}],"args_string":"(response : HTTP::Server::Response)","source_link":null,"source_link":null,"def":{"name":"new","args":[{"name":"response","doc":null,"default_value":"","external_name":"response","restriction":"HTTP::Server::Response"}],"double_splat":null,"splat_index":null,"yields":null,"block_arg":null,"return_type":"","visibility":"Public","body":"_ = allocate\n_.initialize(response)\nif _.responds_to?(:finalize)\n  ::GC.add_finalizer(_)\nend\n_\n"}}],"instance_methods":[{"id":"hatty_send_status_code:Bool-instance-method","html_id":"hatty_send_status_code:Bool-instance-method","name":"hatty_send_status_code","doc":"NOTE: INTERNAL PROPERTY.\nThis property tells Hatty if it should forward the request\nto a status handler.","summary":"<p><span class=\"flag purple\">NOTE</span>  INTERNAL PROPERTY.</p>","abstract":false,"args":[],"args_string":" : Bool","source_link":null,"source_link":null,"def":{"name":"hatty_send_status_code","args":[],"double_splat":null,"splat_index":null,"yields":null,"block_arg":null,"return_type":"Bool","visibility":"Public","body":"@hatty_send_status_code"}},{"id":"hatty_sent:Bool-instance-method","html_id":"hatty_sent:Bool-instance-method","name":"hatty_sent","doc":"NOTE: INTERNAL PROPERTY.\nThis property tells Hatty if the response has been used.","summary":"<p><span class=\"flag purple\">NOTE</span>  INTERNAL PROPERTY.</p>","abstract":false,"args":[],"args_string":" : Bool","source_link":null,"source_link":null,"def":{"name":"hatty_sent","args":[],"double_splat":null,"splat_index":null,"yields":null,"block_arg":null,"return_type":"Bool","visibility":"Public","body":"@sent"}},{"id":"headers:HTTP::Headers-instance-method","html_id":"headers:HTTP::Headers-instance-method","name":"headers","doc":null,"summary":null,"abstract":false,"args":[],"args_string":" : HTTP::Headers","source_link":null,"source_link":null,"def":{"name":"headers","args":[],"double_splat":null,"splat_index":null,"yields":null,"block_arg":null,"return_type":"HTTP::Headers","visibility":"Public","body":"@response.headers"}},{"id":"original:HTTP::Server::Response-instance-method","html_id":"original:HTTP::Server::Response-instance-method","name":"original","doc":"Returns the original response","summary":"<p>Returns the original response</p>","abstract":false,"args":[],"args_string":" : HTTP::Server::Response","source_link":null,"source_link":null,"def":{"name":"original","args":[],"double_splat":null,"splat_index":null,"yields":null,"block_arg":null,"return_type":"HTTP::Server::Response","visibility":"Public","body":"@response"}},{"id":"send(response):Nil-instance-method","html_id":"send(response):Nil-instance-method","name":"send","doc":"Sends the *response* \"as-is\" to the client.\n```\nget \"/\" do |request, response|\n  response.send \"Hellooo!\"\nend\n```","summary":"<p>Sends the <em>response</em> \"as-is\" to the client.</p>","abstract":false,"args":[{"name":"response","doc":null,"default_value":"","external_name":"response","restriction":""}],"args_string":"(response) : Nil","source_link":null,"source_link":null,"def":{"name":"send","args":[{"name":"response","doc":null,"default_value":"","external_name":"response","restriction":""}],"double_splat":null,"splat_index":null,"yields":null,"block_arg":null,"return_type":"Nil","visibility":"Public","body":"if @sent\n  raise(ExhaustedError.new)\nend\n@response.print(response)\n@sent = true\n"}},{"id":"send_json(json:String):Nil-instance-method","html_id":"send_json(json:String):Nil-instance-method","name":"send_json","doc":"Sends the *response* as `application/json` to the client.","summary":"<p>Sends the <em>response</em> as <code>application/json</code> to the client.</p>","abstract":false,"args":[{"name":"json","doc":null,"default_value":"","external_name":"json","restriction":"String"}],"args_string":"(json : String) : Nil","source_link":null,"source_link":null,"def":{"name":"send_json","args":[{"name":"json","doc":null,"default_value":"","external_name":"json","restriction":"String"}],"double_splat":null,"splat_index":null,"yields":null,"block_arg":null,"return_type":"Nil","visibility":"Public","body":"@response.content_type = \"application/json\"\nsend(json)\n"}},{"id":"send_json(jsonjsonable):Nil-instance-method","html_id":"send_json(jsonjsonable):Nil-instance-method","name":"send_json","doc":"Sends the *response* as `application/json` to the client.\nNOTE: The *response* must have a `#to_json` method. Hatty automatically requires the JSON module which adds such method to `Hash`, `NamedTuple` and others.\n```\nget \"/\" do |request, response|\n  json = {hello: \"world\"}\n  response.send_json(json)\nend\n```\nThe client receives\n```json\n{\"hello\": \"world\"}\n```","summary":"<p>Sends the <em>response</em> as <code>application/json</code> to the client.</p>","abstract":false,"args":[{"name":"jsonable","doc":null,"default_value":"","external_name":"json","restriction":""}],"args_string":"(json jsonable) : Nil","source_link":null,"source_link":null,"def":{"name":"send_json","args":[{"name":"jsonable","doc":null,"default_value":"","external_name":"json","restriction":""}],"double_splat":null,"splat_index":null,"yields":null,"block_arg":null,"return_type":"Nil","visibility":"Public","body":"@response.content_type = \"application/json\"\nsend(jsonable.to_json)\n"}},{"id":"send_status(status_code):Nil-instance-method","html_id":"send_status(status_code):Nil-instance-method","name":"send_status","doc":"Forwards the request to the status handlers.\n\nExample: Imaginary admin page with authorization\n```\nget \"/admin\" do |request, response|\n  authorized = MyApi.valid_token?(request.headers[\"Authorization\"]?)\n  if !authorized\n    response.send_status 401\n    next\n  end\n  # ...\nend\n\n# `Response#send_status 401` forwards the request to this handler\nstatus 401 do |request, response|\n  response.send_text \"ERR! Unauthorized.\"\nend\n```\n","summary":"<p>Forwards the request to the status handlers.</p>","abstract":false,"args":[{"name":"status_code","doc":null,"default_value":"","external_name":"status_code","restriction":""}],"args_string":"(status_code) : Nil","source_link":null,"source_link":null,"def":{"name":"send_status","args":[{"name":"status_code","doc":null,"default_value":"","external_name":"status_code","restriction":""}],"double_splat":null,"splat_index":null,"yields":null,"block_arg":null,"return_type":"Nil","visibility":"Public","body":"@status_code = status_code\nif @sent\n  raise(ExhaustedError.new)\nend\nif @hatty_send_status_code\n  raise(ExhaustedError.new)\nend\n@hatty_send_status_code = true\n"}},{"id":"send_text(text):Nil-instance-method","html_id":"send_text(text):Nil-instance-method","name":"send_text","doc":"Sends the *text* as `text/plain` to the client.\n```\nget \"/\" do |request, response|\n  response.send_text \"FeelsGoodMan\"\nend\n```\nThe client receives\n```text\nFeelsGoodMan\n```","summary":"<p>Sends the <em>text</em> as <code>text/plain</code> to the client.</p>","abstract":false,"args":[{"name":"text","doc":null,"default_value":"","external_name":"text","restriction":""}],"args_string":"(text) : Nil","source_link":null,"source_link":null,"def":{"name":"send_text","args":[{"name":"text","doc":null,"default_value":"","external_name":"text","restriction":""}],"double_splat":null,"splat_index":null,"yields":null,"block_arg":null,"return_type":"Nil","visibility":"Public","body":"@response.content_type = \"text/plain\"\nsend(text)\n"}},{"id":"status_code:Int32-instance-method","html_id":"status_code:Int32-instance-method","name":"status_code","doc":null,"summary":null,"abstract":false,"args":[],"args_string":" : Int32","source_link":null,"source_link":null,"def":{"name":"status_code","args":[],"double_splat":null,"splat_index":null,"yields":null,"block_arg":null,"return_type":"","visibility":"Public","body":"@status_code"}},{"id":"status_code=(code)-instance-method","html_id":"status_code=(code)-instance-method","name":"status_code=","doc":null,"summary":null,"abstract":false,"args":[{"name":"code","doc":null,"default_value":"","external_name":"code","restriction":""}],"args_string":"(code)","source_link":null,"source_link":null,"def":{"name":"status_code=","args":[{"name":"code","doc":null,"default_value":"","external_name":"code","restriction":""}],"double_splat":null,"splat_index":null,"yields":null,"block_arg":null,"return_type":"","visibility":"Public","body":"@status_code = code\n@response.status_code = code\n"}}],"macros":[],"types":[{"html_id":"/Hatty/Response/ExhaustedError","path":"Hatty/Response/ExhaustedError.html","kind":"class","full_name":"Hatty::Response::ExhaustedError","name":"ExhaustedError","abstract":false,"superclass":{"html_id":"/Exception","kind":"class","full_name":"Exception","name":"Exception"},"ancestors":[{"html_id":"/Exception","kind":"class","full_name":"Exception","name":"Exception"},{"html_id":"/Reference","kind":"class","full_name":"Reference","name":"Reference"},{"html_id":"/Object","kind":"class","full_name":"Object","name":"Object"}],"locations":[],"repository_name":"","program":false,"enum":false,"alias":false,"aliased":"","const":false,"constants":[],"included_modules":[],"extended_modules":[],"subclasses":[],"including_types":[],"namespace":{"html_id":"/Hatty/Response","kind":"class","full_name":"Hatty::Response","name":"Response"},"doc":null,"summary":null,"class_methods":[],"constructors":[{"id":"new-class-method","html_id":"new-class-method","name":"new","doc":null,"summary":null,"abstract":false,"args":[],"args_string":"","source_link":null,"source_link":null,"def":{"name":"new","args":[],"double_splat":null,"splat_index":null,"yields":null,"block_arg":null,"return_type":"","visibility":"Public","body":"_ = allocate\n_.initialize\nif _.responds_to?(:finalize)\n  ::GC.add_finalizer(_)\nend\n_\n"}}],"instance_methods":[],"macros":[],"types":[]}]},{"html_id":"/Hatty/Server","path":"Hatty/Server.html","kind":"class","full_name":"Hatty::Server","name":"Server","abstract":false,"superclass":{"html_id":"/Reference","kind":"class","full_name":"Reference","name":"Reference"},"ancestors":[{"html_id":"/Reference","kind":"class","full_name":"Reference","name":"Reference"},{"html_id":"/Object","kind":"class","full_name":"Object","name":"Object"}],"locations":[],"repository_name":"","program":false,"enum":false,"alias":false,"aliased":"","const":false,"constants":[],"included_modules":[],"extended_modules":[],"subclasses":[],"including_types":[],"namespace":{"html_id":"/Hatty","kind":"module","full_name":"Hatty","name":"Hatty"},"doc":null,"summary":null,"class_methods":[],"constructors":[{"id":"new(port)-class-method","html_id":"new(port)-class-method","name":"new","doc":null,"summary":null,"abstract":false,"args":[{"name":"port","doc":null,"default_value":"","external_name":"port","restriction":""}],"args_string":"(port)","source_link":null,"source_link":null,"def":{"name":"new","args":[{"name":"port","doc":null,"default_value":"","external_name":"port","restriction":""}],"double_splat":null,"splat_index":null,"yields":null,"block_arg":null,"return_type":"","visibility":"Public","body":"_ = allocate\n_.initialize(port)\nif _.responds_to?(:finalize)\n  ::GC.add_finalizer(_)\nend\n_\n"}}],"instance_methods":[{"id":"handle_request(context)-instance-method","html_id":"handle_request(context)-instance-method","name":"handle_request","doc":"NOTE: INTERNAL METHOD","summary":"<p><span class=\"flag purple\">NOTE</span>  INTERNAL METHOD</p>","abstract":false,"args":[{"name":"context","doc":null,"default_value":"","external_name":"context","restriction":""}],"args_string":"(context)","source_link":null,"source_link":null,"def":{"name":"handle_request","args":[{"name":"context","doc":null,"default_value":"","external_name":"context","restriction":""}],"double_splat":null,"splat_index":null,"yields":null,"block_arg":null,"return_type":"","visibility":"Public","body":"path = context.request.path\nmethod = context.request.method\nrequest = Request.new(context.request)\nresponse = Response.new(context.response)\nbegin\n  handler = Router.get_handler(method, path)\n  handler.call(request, response)\n  if response.hatty_send_status_code\n    Router.send_status(response.status_code, request, response)\n  end\nrescue error : Router::NotFoundError\n  Router.send_status(404, request, response)\nrescue error\n  Router.send_status(500, request, response)\n  context.response.close\n  raise(error)\nend\n"}},{"id":"native:HTTP::Server-instance-method","html_id":"native:HTTP::Server-instance-method","name":"native","doc":null,"summary":null,"abstract":false,"args":[],"args_string":" : HTTP::Server","source_link":null,"source_link":null,"def":{"name":"native","args":[],"double_splat":null,"splat_index":null,"yields":null,"block_arg":null,"return_type":"","visibility":"Public","body":"@server"}},{"id":"start-instance-method","html_id":"start-instance-method","name":"start","doc":"Starts Hatty.","summary":"<p>Starts Hatty.</p>","abstract":false,"args":[],"args_string":"","source_link":null,"source_link":null,"def":{"name":"start","args":[],"double_splat":null,"splat_index":null,"yields":null,"block_arg":null,"return_type":"","visibility":"Public","body":""}},{"id":"stop-instance-method","html_id":"stop-instance-method","name":"stop","doc":null,"summary":null,"abstract":false,"args":[],"args_string":"","source_link":null,"source_link":null,"def":{"name":"stop","args":[],"double_splat":null,"splat_index":null,"yields":null,"block_arg":null,"return_type":"","visibility":"Public","body":"@server.close"}}],"macros":[],"types":[]}]}]}}